## Шрифты

Конструкция для подключения шрифтов CSS.
TODO: добавить информацию по переменным шрифтов

```css
@font-face {
font-family: 'Avenir Next';
font-display: swap;
font-style: normal;
font-weight: 400;
src:
    url('../fonts/avenir-next-regular.woff2') format('woff2'),
    url('../fonts/avenir-next-regular.woff') format('woff');

}
```

### Font Display

**font-display** — это не CSS-свойство, которое можно применить к конкретному элементу. 
Это так называемый дескриптор. Он применяется только внутри секции правил @font-face и описывает, 
как будет отображаться текст в зависимости от того, загружен шрифт или нет.

Возможные значения:

1. **auto** — стратегия загрузки шрифта определяется браузером в автоматическом режиме. То есть, какую длительность периодов заложили разработчики браузера, такая и будет применяться. Зачастую эта стратегия очень близка к той, что задаётся значением block.

2. **block** — стратегия загрузки шрифта, при которой задаётся короткий (порядка 3 секунд) период блокировки и бесконечный период замены. Другими словами, пока грузится шрифт, браузер весь текст показывает невидимым запасным шрифтом, а после загрузки шрифта переключается на этот шрифт.
Используем это значение в исключительных случаях. Например, если страницу невозможно нормально использовать без именно этого шрифта. Яркий пример: иконочный шрифт. До момента загрузки такого шрифта при других стратегиях браузер будет показывать обычный символ алфавита вместо иконки, что может сбить с толку и не дать нормально пользоваться страницей.

3. **swap** — задаёт очень короткий (менее 100 миллисекунд) период блокировки и бесконечный период замены. При такой стратегии браузер практически сразу отображает текст запасным шрифтом, а затем, когда подгружен нужный шрифт, переключается на него.
Используем это значение, когда раннее отображение текста является приоритетной задачей, но отображение текста другим шрифтом не нарушает нормального использования страницы. Желательно такую стратегию применять только к небольшим фрагментам текста. Яркий пример: отображение логотипа компании. В целом другой шрифт не усложнит пользование страницей, но правильный логотип важен с точки зрения продвижения бренда.

4. **fallback** — такая стратегия, при которой задаётся очень короткий (менее 100 миллисекунд) период блокировки, а так же короткий (порядка 3 секунд) период замены. В этом случае браузер практически сразу отображает текст запасным шрифтом, затем, когда подгружен нужный шрифт, переключается на него, но если шрифт не загрузился, остаётся на запасном шрифте.
Желательно это значение использовать для основного текста, а так же для больших фрагментов текста. Как правило, это значение используется в ситуациях, когда желательно отобразить текст нужным шрифтом, но ничего страшного, если этот текст будет написан другим шрифтом. Использование этого значения помогает сразу же отобразить текст страницы, чтобы пользователь мог прочитать его как можно раньше.

5. **optional** — самая сложная стратегия: период блокировки очень короткий (порядка 100 миллисекунд), а вот период замены не задан.
Это значит, что если шрифт стал доступен в период блокировки (то есть, очень быстро), то он и будет использоваться. В противном случае браузер считает, что ни в период блокировки, ни в период замены шрифт загрузить не удалось. Если к этому моменту шрифт ещё не понадобился для отрисовки элемента, браузер будет решать отменить загрузку этого шрифта или продолжить с очень низким приоритетом.

### Вариативные шрифты

Вариативные шрифты — это расширение формата OpenType, которое позволяет хранить все варианты начертаний в одном файле, 
а для переключения между ними использовать не только фиксированные шаги, но и промежуточные значения. 
Например, вместо привычных значений жирности вроде 100, 400, 700 можно будет задать 75 или 650, 
и так же гибко можно настроить ширину символа от самого сжатого до самого широкого задав любое значение 
в предопределённом диапазоне, и всё это без загрузки дополнительных файлов.

Возможности нового формата решают сразу две проблемы: 

- Во-первых, 
снимаются ограничения на количество доступных начертаний: они больше не требуют отдельных файлов, 
а количество сочетаний ограничивается только настройками шрифта и фантазией разработчика. 

- Во-вторых, для получения любого количества разных начертаний на страницу достаточно будет подключить всего один файл,
что позволит сэкономить трафик и быстрее показывать страницы пользователю.

Подробнее об этом можно прочитать [здесь](https://web-standards.ru/articles/introduction-to-variable-fonts/)

### FOUT и FOIT

**FOIT** - Flash of Invisible Text означает «Вспышка невидимого текста». Этот механизм загрузки шрифтов решает,
что при рендеринге страницы фрагменты текста останутся с пустыми шрифтами до тех пор,
пока не будут найдены исходные шрифты.

В этом случае дизайнер решил не показывать какой-либо шрифт до тех пор, пока оригинал не будет отрендерен, 
а затем открыт, что сделает видимым весь письменный контент.

**FOUT** - Flash of Unstyled Text означает « Вспышка нестилизованного текста ». Это механизм загрузки страницы, который отдает приоритет полному отображению содержимого как можно быстрее .

Для этого во время рендеринга FOUT загружает общие шрифты до тех пор, пока не будут найдены и затем загружены исходные. 
Он фокусируется на содержании, хотя на мгновение игнорирует макет.

Подробнее об этом можно прочитать [здесь](https://rockcontent.com/blog/foit-vs-fout-comparison-webfont-loading/)

### Optimization checklist

Помогайте браузеру оптимизировать загрузку шрифтов и их использование.

- **Убедитесь, что шрифты, которые вы загружаете необходимы.** Не используйте слишком много разновидностей,
  и вариаций для каждого из них. Это напрямую влияет на загрузку страницы. Также это плохо отражается на консистентности дизайна,
  что отрицательно сказывается на UX.
- **Избавьтесь от ненужных подмножеств unicode символов.** Проще говоря, уберите ненужные языки из вашего шрифта.
  Например, для английского сайта совсем не обязательно иметь поддержку всех языков европы.
  Вместо этого, вы можете выделить эти их в отдельные файлы, и подключать по мере необходимости.
  Это положительно скажется на размере файлов, а значит и на скорости загрузки страницы.
- **Используйте актуальные форматы шрифтов.** На данный момент, для всех современных браузеров, актуальны следующие форматы:
  woff2, woff для IE11.
- **Используйте preload.** Браузер начнет загружать эти шрифты намного раньше, что позволит, в самое короткое время, применить их для страницы.
Пример:

  ```html
  <link rel="preload" href="/my-font.woff2" as="font" type="font/woff2"/>
  ```

- **Если вы используете CDN или хостинг, убедитесь что они выставляют для шрифтов атрибут с большим cache-time параметром.**
  Это поможет пользователям загружать эти шрифты меньшее количество раз.

### Кеширование шрифтов

Для проверки работоспособности шрифта не забывайте,
что надо выключать опцию disable cache во вкладке devtools инструментов разработчиков.

### Платные шрифты

Вам необходимо проверять доступность шрифта, который используется дизайнером на странице.
Бесплатный? Cкачиваем нужные версии и используем их в проекте.
Платный? Отправляем запрос к дизайнеру/менеджеру/тим лиду, чтобы получить необходимые исходники шрифтов.

Проверять доступность шрифта можно здесь:

- [Google fonts](https://fonts.google.com/)
- [Fontsquirrel](https://www.fontsquirrel.com/)
