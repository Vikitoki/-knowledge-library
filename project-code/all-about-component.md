# Всё про компонент

## Компонент

SomeComponentName

1. **tests** - папка для jest-тестов. testName.test.ts|tsx - в одном файле не должна собираться портянка из тестов, для каждого отдельного логического теста, свой файл

2. helpers - папка для каких-то вспомогательных функций, которые используются в компонентах ниже, но не дотягивают до того, чтобы оказаться в папке shared проекта, т.е. что-то переиспользуемое, но только в этом компоненте или его детях.

3. components - если в компоненте, потребовалось сделать другие компоненты, которые используются только в этом компоненте, то создаём папку components и в ней эта структура повторяется.

4. types - если в дочерних компонентах используется один и тот же тип, и он не используется где-то во вне, то тип выносится из файла компонента и распологается выше по иерархии в структуре вплоть до корневой папки types.

5. index.tsx - основной файл компонента.

6. style.ts - основной файл стилей

7. constants - папка для констант.

## Контент страницы

в Папке routes-content размещаем контент страниц (+ подкомпоненты использующиеся только на этой странице)

```
routes-content
  route-name
    contentFirst
      __tests__
        testName.test.ts|tsx
      components
      helpers
      types
      index.tsx
      style.ts
    contentSecond
      __tests__
        testName.test.ts|tsx
      components
      helpers
      types
      index.ts
      style.ts

```

- В директории проекта есть папка components, в которой находятся 2 папки pure и specific. В pure только общие ui компоненты (кнопки, ссылки, лейауты, футер, карточки и т.п.). в specific находятся компоненты, которые используются в нескольких местах одновременно и являются специфичными для данной страницы или страниц с одним и тем же URL (например returns/upload и returns/invoices).

- В каждой из папок компонента нужно стараться держать только файл index.ts. Всё для того, чтобы путь импорта был короче.

## Динамический роутинг

В разработке

## Alias

В проекте реализованы псевдонимы для путей, которые нужно использовать. Не нужно писать import SomeComponent from '../../../../../components/Link'. Лучше так:

```javascript
import SomeComponent from "~components/Link";
```

Структура:

```
  ~ - корень
  ~components - общие компонент
  ~routes-content - компонента контента страниц + дети
  ~store - глобальное хранилище
  ~shared - общие вспомогательные функции присущие для определённых страниц
  ~utils - общие вспомогательные функции для переиспользования по всему проекту
  ~public - публичная папка для картинок, шрифта, иконок и т.д.
  ~constants - общие константы проекта, breakpoints к примеру
  ~styles - глобальные стили
  ~types - общие типы
```

- Если необходимого псевдонима почему-то нет, то либо он не нужен, и разработчик что-то делает не так, либо нужно добавить новый

## Комментирование сложных фич, костылей, саг и эффектов

- Какие-то неявные "магические" участки кода - комментируй
- Начало саги и сервиса - комментируй
- Если нужно что-то залогировать через console.log и отправить это в продакшен для дальнейшей доработки, то делаем это по шаблону:

  ```javascript
    console.log('ComponentName: FunctionName(если это функция) Какой-то текст', какие-то данные)
  ```

## Тех долг

В проекте мы не заметаем проблемы "под ковёр". Если при выполнении какой-то задачи, или по завершению своей, разработчик понимает, что какой-то участок кода или компонент можно\нужно написать лучше, то сам разработчик создаёт такую задачу в менеджере задач с меткой "техдолг" или "рефактор". В ней расписывается суть задачи и обоснование, далее в случае апрува, эта задача будет реализована по мере появления "свободного" времени у разработчиков

## TypeScript

### Порядок сущностей внутри \*.ts(x) файлов

```javascript

  // 1. Импорты
  import React from 'React'

  // 2. Типы
  type TData = [...]
  type TProps = {
      data: TData
  }

  // 3. Константы
  const MAX_WIDTH = 100

  // 4. Styled-components
  const InputWrapper = styled.div<{compactWidth: number, isShowSearchInput: boolean}>``

  // 5. Компонент
  export const SomeComp: React.FC<SomeCompProps> = ({ someValue = 'defaultValue' }) => {
      const items = getTransformData(data)
      return <ul>{items.map(item => <ListItem {...item} />)}</ul>
  }

```

### Комментарии к типам

Для описания полей типа нужно оставлять многострочный комментарий. Это необходимо для верной генерации документации. Пример:

```javascript
type UserProps = {
  /** Имя пользователя */
  name: string,
  /** Какое-то описание ключа */
  someKey?: someType,
};
```

### Type vs Interface

Стоит использовать type (не interface) для объявления props, да и для любых других типов. interface стоит использовать тогда, когда вы описываете общий тип, который где-то нужно имплементировать. Примером такого случая может являться интерфейс IWidget. Он описывает общий публичный API виджетов, поэтому и является интерфейсом. Интерфейсы хорошо подходят для написания абстрактного кода, который не работает с конкретными типами или экземлярами, а ожидает получить любую сущность, реализующего заданный интерфейс. Подробноее по type vs interface можно почитать [здесь](https://medium.com/@martin_hotell/interface-vs-type-alias-in-typescript-2-7-2a8f1777af4c)

### Default Props

Не стоит использовать defaultProps в function component, вместо этого нужно использовать значения по умолчанию при деструктуризации props:

```javascript
const SomeComp: React.FC<SomeCompProps> = ({
  someValue = "defaultValue",
}) => {};
```

### Использование enums

Ипользовать enum следует для объявления публичных или общих "перечислимых" типов. Если ваш тип предполагает использование вне компонента, то следует его объявить через enum. Например:

```javascript
enum EStatuses {
  NORMAL = 'normal',
  DANGER = 'danger',
  WARNING = 'warning',
}
```

Это позволит переиспользовать этот тип во внешних компонентах (если их будут реализовывать сторонние разработчики). Не обязательно явно указывать значения enum, как в случае выше, но это может быть удобным, если вам нужно конкретное значение enum (чтобы избежать дополнительного парсинга значений). Если тип конкретного компонента должен принимать только одно значение из enum, то можно делать так:

```javascript
type TComponentProps = {
  status: EStatuses.Normal,
};
```
